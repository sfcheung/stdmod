<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Compute Standardized Moderation Effect in SEM using stdmod_lavaan â€¢ stdmod</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Compute Standardized Moderation Effect in SEM using stdmod_lavaan">
<meta property="og:description" content="stdmod">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stdmod</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/numerical_example_01.html">Numerical Example - stdmod_selected</a>
    </li>
    <li>
      <a href="../articles/numerical_example_02.html">Compute the Standardized Moderation Effect by stdmod_selected</a>
    </li>
    <li>
      <a href="../articles/numerical_example_lavaan.html">Compute Standardized Moderation Effect in SEM using stdmod_lavaan</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="numerical_example_lavaan_files/header-attrs-2.4/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Compute Standardized Moderation Effect in SEM using stdmod_lavaan</h1>
                        <h4 class="author">Shu Fai Cheung and David Weng Ngai Vong</h4>
            
            <h4 class="date">2021-03-02</h4>
      
      
      <div class="hidden name"><code>numerical_example_lavaan.Rmd</code></div>

    </div>

    
    
<div id="purpose" class="section level1">
<h1 class="hasAnchor">
<a href="#purpose" class="anchor"></a>Purpose</h1>
<p>This document demonstrates how to use <code>stdmod_lavaan</code> to compute the standarized moderation effect in a path analytic model fitted by <code>lavaan</code>.</p>
</div>
<div id="setup-the-environment" class="section level1">
<h1 class="hasAnchor">
<a href="#setup-the-environment" class="anchor"></a>Setup the Environment</h1>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stdmod</span><span class="op">)</span> <span class="co"># For computing the standardized moderation effect conveniently</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://lavaan.org">lavaan</a></span><span class="op">)</span> <span class="co"># For doing path analysis in lavaan.</span>
<span class="co">#&gt; This is lavaan 0.6-7</span>
<span class="co">#&gt; lavaan is BETA software! Please report any bugs.</span></pre></div>
</div>
<div id="load-the-dataset" class="section level1">
<h1 class="hasAnchor">
<a href="#load-the-dataset" class="anchor"></a>Load the Dataset</h1>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">sleep_emo_con</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">sleep_emo_con</span><span class="op">)</span>
<span class="co">#&gt;   case_id sleep_duration conscientiousness emotional_stability age gender</span>
<span class="co">#&gt; 1       1              6               3.6                 3.6  20 female</span>
<span class="co">#&gt; 2       2              4               3.8                 2.4  20 female</span>
<span class="co">#&gt; 3       3              7               4.3                 2.7  20 female</span>
<span class="co">#&gt; 4       4              8               2.9                 1.3  20 female</span>
<span class="co">#&gt; 5       5              8               3.3                 2.6  22 female</span>
<span class="co">#&gt; 6       6              8               2.4                 2.2  25 female</span></pre></div>
<p>This data set has 500 cases of data. The variables are sleep duration, age, gender, and the scores from two personality scales, emotional stability and conscientiousness of the IPIP Big Five markers. Please refer to (citation to be added) for the detail of the data set.</p>
</div>
<div id="compute-the-product-term-in-the-path-analytic-model" class="section level1">
<h1 class="hasAnchor">
<a href="#compute-the-product-term-in-the-path-analytic-model" class="anchor"></a>Compute the product term in the path analytic model</h1>
<p>Since the product term cannot be automatically generated through the function in SEM (the way of simply using variable A*variable B to specify the product term will not work in <code>lavaan</code>), we need to compute the product term manually.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="va">sleep_emo_con</span><span class="op">$</span><span class="va">emo_con</span> <span class="op">&lt;-</span> 
  <span class="va">sleep_emo_con</span><span class="op">$</span><span class="va">emotional_stability</span> <span class="op">*</span> <span class="va">sleep_emo_con</span><span class="op">$</span><span class="va">conscientiousness</span></pre></div>
</div>
<div id="specify-the-model-in-sem-and-fit-the-model-by-lavaan" class="section level1">
<h1 class="hasAnchor">
<a href="#specify-the-model-in-sem-and-fit-the-model-by-lavaan" class="anchor"></a>Specify the model in SEM and fit the model by <code>lavaan</code>
</h1>
<p>After computing the product term of the model, the remaining process is just following the normal procedures of constructing SEM in R using <code>lavaan</code>. We specify the model by using age, gender, emotional stability, conscientiousness and the product term of emotional stability and conscientiousness to predict the sleep duration. Therefore, we conduct the a SEM with a moderator as follow:</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="va">mod</span> <span class="op">&lt;-</span> 
  <span class="st">'
  sleep_duration ~ age + gender + emotional_stability + conscientiousness + emo_con
  '</span>

<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">sleep_emo_con</span>, likelihood <span class="op">=</span> <span class="st">"wishart"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="co">#&gt; lavaan 0.6-7 ended normally after 27 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Estimator                                         ML</span>
<span class="co">#&gt;   Optimization method                           NLMINB</span>
<span class="co">#&gt;   Number of free parameters                          6</span>
<span class="co">#&gt;                                                       </span>
<span class="co">#&gt;   Number of observations                           500</span>
<span class="co">#&gt;                                                       </span>
<span class="co">#&gt; Model Test User Model:</span>
<span class="co">#&gt;                                                       </span>
<span class="co">#&gt;   Test statistic                                 0.000</span>
<span class="co">#&gt;   Degrees of freedom                                 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Parameter Estimates:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Standard errors                             Standard</span>
<span class="co">#&gt;   Information                                 Expected</span>
<span class="co">#&gt;   Information saturated (h1) model          Structured</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Regressions:</span>
<span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span>
<span class="co">#&gt;   sleep_duration ~                                    </span>
<span class="co">#&gt;     age               0.018    0.021    0.843    0.399</span>
<span class="co">#&gt;     gender           -0.261    0.165   -1.584    0.113</span>
<span class="co">#&gt;     emotinl_stblty    1.322    0.448    2.949    0.003</span>
<span class="co">#&gt;     conscientisnss    1.204    0.369    3.265    0.001</span>
<span class="co">#&gt;     emo_con          -0.331    0.132   -2.509    0.012</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Variances:</span>
<span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span>
<span class="co">#&gt;    .sleep_duration    1.897    0.120   15.796    0.000</span></pre></div>
<p>The results show that conscientiousness significantly moderates the effect of emotional stability on sleep duration.</p>
<p><em>Note</em>: The argument <code>Likelihood = wishart</code> is provided as it ensures that the SEM results are identical to the linear regression results estimated by OLS, for illustration only. Users are not required to use this argument when they are conducting fitting their models in their studies.</p>
</div>
<div id="compute-the-standardized-moderation-effect" class="section level1">
<h1 class="hasAnchor">
<a href="#compute-the-standardized-moderation-effect" class="anchor"></a>Compute the standardized moderation effect</h1>
<p>After fitting the SEM model by <code>lavaan</code>, we can use the function <code>stdmod_lavaan</code> to compute the standardized moderation effect. Noted that the function can be slow if nonparametric bootstrapping confidence interval is requested by setting <code>boot_ci</code> to <code>TRUE</code>. Therefore, we highly suggest using parallel processing if possible when nonparametric bootstrapping confidence interval is to be computed.</p>
<p>If nonparametric bootstrapping confidence interval is requested, <code>stdmod_lavaan</code> accepts arguments to be passed to <code><a href="https://rdrr.io/pkg/boot/man/boot.html">boot::boot</a></code>. In the following example, the argumetns <code>parallel</code>, <code>ncpus</code>, and <code>seed</code> are arguments for <code><a href="https://rdrr.io/pkg/boot/man/boot.html">boot::boot</a></code>. For example, <code>ncpus</code> specifies the number of CPU cores that users wish to use for parallel processing.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">515464</span><span class="op">)</span> <span class="co"># Set the random seed</span>
<span class="va">out_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stdmod_lavaan.html">stdmod_lavaan</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit</span>, x <span class="op">=</span> <span class="st">"emotional_stability"</span>,
                          y <span class="op">=</span> <span class="st">"sleep_duration"</span>,
                          w <span class="op">=</span> <span class="st">"conscientiousness"</span>,
                          x_w <span class="op">=</span> <span class="st">"emo_con"</span>,
                          boot_ci <span class="op">=</span> <span class="cn">TRUE</span>, R <span class="op">=</span> <span class="fl">2000</span>,
                          parallel <span class="op">=</span> <span class="st">"snow"</span>, ncpus <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>

<span class="va">out_boot</span><span class="op">$</span><span class="va">stdmod</span>
<span class="co">#&gt; sleep_duration~emo_con </span>
<span class="co">#&gt;             -0.1082917</span></pre></div>
<p>The standardized moderation effect is in the element <code>stdmod</code>. In this example, the standardized moderation effect is -0.1082917.</p>
<p>Nonparametric bootstrapping confidence interval is in the element <code>ci</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="va">out_boot</span><span class="op">$</span><span class="va">ci</span>
<span class="co">#&gt; lower_bound upper_bound </span>
<span class="co">#&gt; -0.20529926 -0.01120234</span></pre></div>
<p>The 95% confidence interval of the standardized moderation effect is -0.2052993 to -0.0112023.</p>
<p>By default, the original output from <code><a href="https://rdrr.io/pkg/boot/man/boot.html">boot::boot</a></code> is stored in the element <code>boot_out</code>. Users can use functions that accept the output of <code><a href="https://rdrr.io/pkg/boot/man/boot.html">boot::boot</a></code>. For example, users can use <code>boot.ci</code> to get the 90% percentile confidence interval as below:</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="fu">boot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.ci.html">boot.ci</a></span><span class="op">(</span><span class="va">out_boot</span><span class="op">$</span><span class="va">boot_out</span>, conf <span class="op">=</span> <span class="fl">.90</span>, type <span class="op">=</span> <span class="st">"perc"</span><span class="op">)</span>
<span class="co">#&gt; BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS</span>
<span class="co">#&gt; Based on 1970 bootstrap replicates</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; CALL : </span>
<span class="co">#&gt; boot::boot.ci(boot.out = out_boot$boot_out, conf = 0.9, type = "perc")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Intervals : </span>
<span class="co">#&gt; Level     Percentile     </span>
<span class="co">#&gt; 90%   (-0.1893, -0.0270 )  </span>
<span class="co">#&gt; Calculations and Intervals on Original Scale</span></pre></div>
</div>
<div id="identical-to-the-result-from-moderated-regression-" class="section level1">
<h1 class="hasAnchor">
<a href="#identical-to-the-result-from-moderated-regression-" class="anchor"></a>Identical to the result from moderated regression.</h1>
<p>For comparison, these are the standardized solution of the same moderated regression model using the normal regression function <code>lm</code> and then processed by <code>stdmod_selected</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="va">lm_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">sleep_duration</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">emotional_stability</span><span class="op">*</span><span class="va">conscientiousness</span>, <span class="va">sleep_emo_con</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">514589</span><span class="op">)</span>
<span class="va">lm_xwy_std_ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/std_selected.html">std_selected_boot</a></span><span class="op">(</span><span class="va">lm_out</span>, to_center <span class="op">=</span> <span class="op">~</span> <span class="va">emotional_stability</span> <span class="op">+</span> <span class="va">conscientiousness</span> <span class="op">+</span> <span class="va">sleep_duration</span>,
                                           to_scale  <span class="op">=</span> <span class="op">~</span> <span class="va">emotional_stability</span> <span class="op">+</span> <span class="va">conscientiousness</span> <span class="op">+</span> <span class="va">sleep_duration</span>,
                                           nboot <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">lm_xwy_std_ci</span><span class="op">)</span><span class="op">[</span><span class="st">"emotional_stability:conscientiousness"</span><span class="op">]</span>
<span class="co">#&gt; emotional_stability:conscientiousness </span>
<span class="co">#&gt;                            -0.1082917</span></pre></div>
<p>We can see that the standardized moderation effect is -0.1082917, equal to that computed by <code>stdmod_lavaan</code>.</p>
</div>
<div id="remarks" class="section level1">
<h1 class="hasAnchor">
<a href="#remarks" class="anchor"></a>Remarks</h1>
<p>The function <code>stdmod_lavaan</code> can be used for more complicated path models. The computation of the standardized moderation effect in a path model depends only on the three variables involved (<code>x</code>, <code>w</code>, and <code>y</code>). We used a simple saturated model in this document only for illustration and comparing the results obtained form OLS moderated regression.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Shu Fai Cheung, David Weng Ngai Vong.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
